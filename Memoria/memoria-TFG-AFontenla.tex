% ---------------------------------------------------
% Trabajo Fin de Grado:
% Author: Adriano dos Santos Moreira <alu0101436784@ull.edu.es>
% Author: F. de Sande fsande@ull.es
% File: memoria-TFG-AdrianoDosSantos.tex
%
% ----------------------------------------------------
% 
\documentclass[english,a4paper,12pt,oneside]{extreport}
\usepackage{listingsutf8}
\usepackage{listings}
\usepackage[scale=0.82]{FiraMono}
\usepackage[T1]{fontenc}
%\documentclass[a4paper, twoside, 12pt]{book}
\usepackage[a4paper]{geometry}
\usepackage[spanish, main=english]{babel}
\usepackage[utf8]{inputenc}
\usepackage{lmodern,textcomp}  % For € symbol
\usepackage{pdflscape}
\usepackage{amsmath}
\usepackage{array}
\newcolumntype{C}[1]{>{\centering\arraybackslash}m{#1}}
\usepackage{makecell}
\usepackage{multirow}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Next 3+3 lines select PDF or PS output (comment as apropriate)
% To switch from PDF and PS comment/uncomment here and change Makefile
\usepackage[pdftex]{xcolor}
\usepackage[pdftex]{graphicx}
\graphicspath{{images/}}
%\usepackage[dvips]{color}
%\usepackage[dvips]{graphicx}
\usepackage{epsfig}
%\graphicspath{{images/eps/}}
\usepackage{floatrow}
\usepackage{tabu}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{algorithmic}
%\usepackage[pdftex=true,colorlinks=false,urlcolor=blue,plainpages=false,pagebackref=true,citecolor=red]{hyperref} %hiperenlaces y backcites
\usepackage[colorlinks=true,urlcolor=blue,plainpages=false,pagebackref=true,citecolor=black]{hyperref} %hiperenlaces y backcites
\hypersetup{breaklinks=true}
% Redefinir el comando \url para cambiar el tamaño del texto de los enlaces
% \let\oldurl\url
% \renewcommand{\url}[1]{{\scriptsize{\oldurl{#1}}}}

\usepackage{url}
\usepackage{subcaption}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Comandos para escribir "siempre igual"
\newcommand{\TitleTopic}{\texttt{Introduction to High Performance Computing with SYCL}}


%%% Traducimos el pseudocodigo
\renewcommand{\algorithmicwhile}{\textbf{mientras}}
\renewcommand{\algorithmicend}{\textbf{fin}}
\renewcommand{\algorithmicdo}{\textbf{hacer}}
\renewcommand{\algorithmicif}{\textbf{si}}
\renewcommand{\algorithmicthen}{\textbf{entonces}}
\renewcommand{\algorithmicrepeat}{\textbf{repetir}}
\renewcommand{\algorithmicuntil}{\textbf{hasta que}}
\renewcommand{\algorithmicelse}{\textbf{en otro caso}}
\renewcommand{\algorithmicfor}{\textbf{para}}

%%%%%%%%%%%%%%%%% Se crea un entorno para listar código fuente %%%%%%%%%%%%%%%
\newenvironment{sourcecode}
{\begin{list}{}{\setlength{\leftmargin}{1em}}\item\scriptsize\bfseries}
{\end{list}}

\newenvironment{littlesourcecode}
{\begin{list}{}{\setlength{\leftmargin}{1em}}\item\tiny\bfseries}
{\end{list}}

\newenvironment{summary}
{\par\noindent\begin{center}\textbf{Abstract}\end{center}\begin{itshape}\par\noindent}
{\end{itshape}}

\newenvironment{keywords}
{\begin{list}{}{\setlength{\leftmargin}{1em}}\item[\hskip\labelsep \bfseries Keywords:]}
{\end{list}}

\newenvironment{palabrasClave}
{\begin{list}{}{\setlength{\leftmargin}{1em}}\item[\hskip\labelsep \bfseries Palabras clave:]}
{\end{list}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\definecolor{marron}       {rgb}{0.496, 0.203, 0.152}
\definecolor{verde-claro}  {rgb}{0.625, 0.734, 0.199}
\definecolor{oscuro}       {rgb}{0.187, 0.141, 0.285}
\definecolor{gris}     	   {rgb}{0.500, 0.500, 0.500}
\definecolor{bgd-listings} {rgb}{0.999, 0.999, 0.900}
\definecolor{gray97}{gray}{.97}
\definecolor{gray75}{gray}{.75}
\definecolor{gray45}{gray}{.45}
\definecolor{gray}{gray}{.45}
\definecolor{Brown}{cmyk}{0,0.81,1,0.60}
\definecolor{OliveGreen}{cmyk}{0.64,0,0.95,0.40}
\definecolor{CadetBlue}{cmyk}{0.62,0.57,0.23,0}
\definecolor{lightlightgray}{gray}{0.9}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Evitar partir palabras al final de la línea
\hyphenpenalty=10000
\tolerance=1000
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Para listados de código
\usepackage{listings}
% \lstloadlanguages{C,C++}
%\lstloadlanguages{python,C}

% Definiendo colores para los listados de código fuente - Univ. Deusto
\definecolor{violet}{rgb}{0.5,0,0.5}
\definecolor{lightgray}{rgb}{.9,.9,.9}
\definecolor{darkgray}{rgb}{.4,.4,.4}
\definecolor{purple}{rgb}{0.65, 0.12, 0.82}
\definecolor{navy}{rgb}{0,0,0.5}
\definecolor{hellgelb}{rgb}{1,1,0.8}
\definecolor{colKeys}{rgb}{0,0,1}
\definecolor{colIdentifier}{rgb}{0,0,0}
\definecolor{colComments}{rgb}{1,0,0}
\definecolor{colString}{rgb}{0,0.5,0}
\definecolor{main-color}{rgb}{0,0,0}
\definecolor{back-color}{rgb}{0.1686, 0.1686, 0.1686}
\definecolor{string-color}{HTML}{953800}
\definecolor{key-color}{HTML}{8250DF}
\definecolor{comment-color}{HTML}{008000}
\definecolor{sycl-color}{HTML}{CF222E}
\definecolor{highlight-color}{HTML}{953800}

%\lstset{morekeywords={pragma copy\_in copy\_out copy omp parallel private reduction shared hicuda loop\_partition over\_tblock over\_thread}}
\lstdefinelanguage{C++}{
  keywords={new, true, false, catch, try, return, null, switch, const, if, in, while, do, else, case, break},
  ndkeywords={class, throw, this},
  sensitive=false,
  comment=[l]{//},
  morecomment=[s]{/*}{*/},
  morestring=[b]',
  morestring=[b]"
}

\lstdefinestyle{cppstyle}{
    language=C++,
    basicstyle = {\ttfamily\color{main-color}\footnotesize},
    backgroundcolor = {\color{back-color}},
    stringstyle = {\color{string-color}},
    keywordstyle = {\color{key-color}},
    keywordstyle = [2]{\color{gray}},
    keywordstyle = [3]{\color{sycl-color}},
    keywordstyle = [4]{\color{highlight-color}},
    keywordstyle = [5]{\color{black}},
    commentstyle = {\color{comment-color}},
    otherkeywords = {++,--,<<,>>,<<<,>>>,+,-,\{,\},\[,\],*,\&,sycl,std},
    morekeywords = [2]{++,--,<<,>>},
    morekeywords = [3]{sycl},
    morekeywords = [4]{std,+,-,{,},[,],*,\&},
    morekeywords = [5]{<<<,>>>},
    columns=flexible,
    tabsize=2,
    frame=single,
    extendedchars=true,
    showspaces=false,
    showstringspaces=false,
    numbers=left,
    numberstyle=\tiny,
    breaklines=true,
    backgroundcolor=\color{white},
    breakautoindent=true,
    captionpos=b
}

\lstset{literate=%
   *{0}{{{\color{darkgray}0}}}1
    {1}{{{\color{darkgray}1}}}1
    {2}{{{\color{darkgray}2}}}1
    {3}{{{\color{darkgray}3}}}1
    {4}{{{\color{darkgray}4}}}1
    {5}{{{\color{darkgray}5}}}1
    {6}{{{\color{darkgray}6}}}1
    {7}{{{\color{darkgray}7}}}1
    {8}{{{\color{darkgray}8}}}1
    {9}{{{\color{darkgray}9}}}1
} 

\lstdefinelanguage{log}{
  keywords={},
  sensitive=false
}

\lstdefinestyle{logstyle}{
    language=log,
    basicstyle = {\ttfamily\color{main-color}\scriptsize},
    backgroundcolor = {\color{back-color}},
    columns=flexible,
    tabsize=2,
    frame=single,
    extendedchars=true,
    showspaces=false,
    showstringspaces=false,
    numbers=left,
    numberstyle=\tiny,
    breaklines=true,
    backgroundcolor=\color{white},
    breakautoindent=true,
    captionpos=b
}

% Otro formato más bonito para código fuente
\newcommand{\codigofuente}[3]{%
  \lstlisting[language=#1,caption={#2}]{#3}%
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}
\renewcommand{\lstlistingname}{Listing}% Listing -> Listado de código
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% First Page
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\pagestyle{empty}
\thispagestyle{empty}

\newcommand{\HRule}{\rule{\linewidth}{1mm}}
\setlength{\parindent}{0mm}
\setlength{\parskip}{0mm}

\vspace*{\stretch{0.5}}

\begin{center}
\includegraphics[scale=1.1]{images/marca-universidad-de-la-laguna-original}\\[15mm]
{\Huge Trabajo de Fin de Grado}
\end{center}

\HRule
\begin{flushright}
        {\Huge \TitleTopic{}} \\[2.5mm]
        {\Large Adriano dos Santos Moreira} \\[5mm]


\end{flushright}
\HRule
\vspace*{\stretch{2}}
\begin{center}
  \Large La Laguna, {\selectlanguage{spanish}\today} 
\end{center}
\setlength{\parindent}{5mm}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Signature page (add the official stamp)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
%\cleardoublepage
\thispagestyle{empty}

D. {\bf Francisco de Sande González}, profesor Titular de Universidad
adscrito al Departamento de Ingeniería Informática y de Sistemas de la Universidad de La Laguna, como tutor y D. \textbf{Alberto Cabrera Pérez}, doctor en Informática por la Universidad de La Laguna e Ingeniero de Software en Codeplay Software Ltd. como co-tutor.

\bigskip

\bigskip
\bigskip
{\bf C E R T I F I C A N}

\bigskip
\bigskip
\bigskip
Que el presente trabajo de Fin de Grado titulado:

\bigskip
``{\it \TitleTopic{}}''

\bigskip
\bigskip
\bigskip
%Cambiar
\noindent ha sido realizado bajo su dirección por D. {\bf Adriano dos Santos Moreira}.

\bigskip
\bigskip

Y para que así conste, en cumplimiento de la legislación vigente y a los efectos
oportunos firman la presente memoria del Trabajo en La Laguna a {\selectlanguage{spanish}\today}.

%\cleardoublepage
\newpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\thispagestyle{empty}

{ \flushright

\begin{LARGE}
Agradecimientos
\end{LARGE}

\hspace{3mm}

\begin{large}


\hspace{3mm}

\hspace{3mm}
Por toda la asistencia que me ha prestado, agradezco a mi tutor Francisco de Sande, por orientarme en el trabajo de fin de grado con sus años de experiencia y criterio distinguido y exigente. Del mismo modo, agradezco sus años de docencia, que lo alaban por lograr transmitir su carácter riguroso a las materias que imparte.

\vspace{5mm}

De igual forma, gracias a mi co-tutor Alberto Cabrera y a Codeplay Software Ltd. por colaborar en la elaboración de este trabajo, su conocimiento profundo de SYCL ha sido de gran utilidad. No solo por saber sobre la plataforma, sino también por enseñarme particularidades y apuntes importantes sobre la programación paralela.

\vspace{5mm}

Asimismo, agradezco a Wooptix por su contribución en el apartado de procesamiento de imágenes de este trabajo.

\vspace{5mm}

Por otra parte, agradezco enormemente a mi familia, mi pareja y mis amigos más cercanos por haber sido un soporte clave durante este periodo de mi vida. Gracias por tener ilusión con cada logro mío y darme ánimos para alcanzar más metas. En especial doy gracias a mis padres por la educación que me han dado y por enseñarme los valores que me hacen querer seguir adelante.

\vspace{5mm}

Este trabajo ha sido financiado por el Ministerio de Ciencia e Innovación a través de los proyectos PID2019-107228RBI00, AEI/10.13039/501100011033, PDC2022-134013I00 y TED2021-131019B-I00.
\end{large}

}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage

\begin{huge}
Licencia
\end{huge}

\bigskip
%* Si quiere permitir que se compartan las adaptaciones de tu obra mientras se comparta de la misma manera
%y NO quieres permitir usos comerciales de tu obra indica:

\begin{center}
\includegraphics[scale=1.5]{images/by-nc-sa_88x31}\\[10mm]
{\Large \copyright~Esta obra está bajo una licencia de Creative Commons Reconocimiento-NoComercial-CompartirIgual 4.0 Internacional.
}
\end{center}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage  %\cleardoublepage
\selectlanguage{spanish}
\begin{abstract}
{\em
El objetivo de este trabajo es desarrollar experimentos con SYCL, una plataforma de abstracción centrada en el paralelismo, como una forma de introducción a la computación de altas prestaciones.
La relevancia de esta plataforma reside en que define un protocolo uniforme para la ejecución paralela, de manera que el código sea portable entre varios proveedores y plataformas.
De esta forma, SYCL actúa como una capa de abstracción que reduce la dependencia entre el código y la plataforma física de ejecución.
La experimentación con SYCL incluye benchmarks comparativos con CUDA y ejecución en serial para ver la competencia práctica de SYCL.
Por otro lado, examinamos SYCL en el contexto de un proyecto real en la industria, desarrollando un programa de procesamiento de imágenes.

El objetivo de este trabajo ha sido introducir al estudiante en el ámbito de la computación de altas
prestaciones, HPC por sus siglas en inglés.
Para ello se ha utilizado como lenguaje vehicular SYCL. 
SYCL es un modelo de programación de alto nivel que se ha desarrollado con el objetivo de mejorar la productividad de la programación 
en entornos de computación heterogénea.
Es asimismo un estándar promovido por Khronos Group que fue anunciado en 2014.
Se trata de un lenguaje específico de dominio de código fuente único basado en C++. 

Sistemas de computación heterogénea son aquellos que utilizan diferentes tipos de núcleos de cómputo como CPUs, GPUs, ASICs, FPGAs o NPUs. 
Al asignar diferentes cargas de trabajo a procesadores diseñados para fines específicos o procesamiento especializado, se mejora tanto el rendimiento como la eficiencia energética.
El enfoque tradicional a la hora de programar este tipo de sistemas obligaba a desarrollar códigos específicos
para los diferentes tipos de aceleradores hardware presentes en el sistema.
Una de las grandes fortalezas de SYCL es que el programador desarrolla un único código fuente escrito en un
lenguaje que es una extensión de C++ y ese mismo código es traducido por el sistema SYCL para su ejecución en
los diferentes aceleradores presentes en la plataforma de cómputo.
Así pues, SYCL actúa como una capa de abstracción que reduce la dependencia entre el código y la plataforma física de ejecución. 

En este Trabajo Fin de Grado, además de la formación en los conceptos y técnicas necesarias para el uso de la
plataforma, se ha incluído la evaluación de diferentes benchmarks que comparan las prestaciones de diferentes
códigos programados tanto usando SYCL como CUDA, el estándar de facto en la programación de GPUs de Nvidia.

Asimismo se ha utilizado SYCL para programar una aplicación de proceso de imágenes para acreditar el beneficio
del uso de esta plataforma frente al enfoque tradicional para este tipo de aplicaciones de cómputo intensivo.
}

\begin{palabrasClave}
Paralelismo, SYCL, Acelerador, Altas Prestaciones, Kernel, Benchmark, Speed-up, Portabilidad.
\end{palabrasClave}
\end{abstract}
\selectlanguage{english}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage  %\cleardoublepage
\begin{abstract}
{\em
The objective of this work is to develop experiments with SYCL, an abstraction platform focused on parallelism, as a way of introduction to high performance computing.
The relevance of this platform lies in the fact that it defines a uniform protocol for parallel execution, so that the code is portable across multiple vendors and platforms.
In this way, SYCL acts as an abstraction layer that reduces the dependency between the code and the physical execution platform.
Experimentation with SYCL includes comparative benchmarks with CUDA and serial execution to see the practical competence of SYCL.
On the other hand, we examine SYCL in the context of a real industry project, developing an image processing program.

The objective of this work has been to introduce the student to the field of high performance computing (HPC).
For this purpose, SYCL has been used as the vehicular language. 
SYCL is a high-level programming model that has been developed with the aim of improving the productivity of programming in heterogeneous computing environments.
It is also a standard promoted by Khronos Group that was announced in 2014.
It is a single source code domain-specific language based on C++. 

Heterogeneous computing systems are those that use different types of computing cores such as CPUs, GPUs, ASICs, FPGAs or NPUs. 
By assigning different workloads to processors designed for specific purposes or specialized processing, both performance and energy efficiency are improved.
The traditional approach to programming such systems required the development of specific code for different types of hardware accelerators present in the system.
One of the great strengths of SYCL is that the programmer develops a single source code written in a language that is an extension of C++. language that is an extension of C++ and that same code is translated by the SYCL system for execution on the different accelerators present in the platform.
Thus, SYCL acts as an abstraction layer that reduces the dependency between the code and the physical execution platform. 

In this Final Degree Project, in addition to the training in the concepts and techniques necessary for the use of the
platform, it has been included the evaluation of different benchmarks that compare the performance of different codes programmed using SYCL as well as codes programmed using both SYCL and CUDA, the de facto standard in Nvidia GPU programming.

SYCL has also been used to program an image processing application to demonstrate the benefit of using this platform versus the traditional approach for this type of computationally intensive applications.
}

\begin{keywords}
Parallelism, SYCL, Accelerator, High Performance, Kernel, Benchmark, Speed-up, Portability.
\end{keywords}

\end{abstract}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage{\pagestyle{empty}}
\thispagestyle{empty}


\pagestyle{myheadings} %my head defined by markboth or markright
% No funciona bien \markboth sin "twoside" en \documentclass, pero al
% ponerlo se dan un montón de errores de underfull \vbox, con lo que no se
% ha puesto.
\markboth{Adriano dos Santos Moreira}{ULL}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Numeracion en romanos
\renewcommand{\thepage}{\roman{page}}
\setcounter{page}{1}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
{
\hypersetup{linkcolor=black}
\tableofcontents
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage{\pagestyle{empty}}
{
\hypersetup{linkcolor=black}
\listoffigures
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage{\pagestyle{empty}}
%\listoftables
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage{\pagestyle{empty}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Numeracion a partir del capitulo I
\renewcommand{\thepage}{\arabic{page}}
\setcounter{page}{1}
% ==========================================================
% --------               Capítulos                ----------
% --------    Estan en el directorio capitulos/   ----------
% ==========================================================
\include{capitulos/Cap0_Preface}
\include{capitulos/Cap1_Goals}
\include{capitulos/Cap2_Related_Technologies}
\include{capitulos/Cap3_SYCL}
\include{capitulos/Cap4_Benchmark_Comparisons}
\include{capitulos/Cap5_Full_SYCL_Implementation}
\include{capitulos/Cap6_Conclusiones_y_Lineas_de_Trabajo_Futuras}
\include{capitulos/Cap7_Conclusions_and_Future_Lines_of_Work}
\include{capitulos/Cap8_Budget}

\addcontentsline{toc}{chapter}{Bibliography}
% \bibliographystyle{plain}
\bibliographystyle{ieeetr}
  % \bibliographystyle{bmc_article} 
\renewcommand{\bibname}{Bibliography}   %  Para que no aparezca Índice de figuras
\bibliography{bibliography}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 
\end{document}
